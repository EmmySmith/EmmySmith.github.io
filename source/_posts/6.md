---
title: å°ç¨‹åºUIè‡ªåŠ¨åŒ–ä¹‹Python
date: 2019-06-06 11:24:13
tags: UI
categories: æŠ€æœ¯
summary_img: /image/6.gif
---


##### UIè‡ªåŠ¨åŒ–ä½œä¸ºæµ‹è¯•æ¥è¯´ä¹Ÿæ˜¯å¾ˆå¿…è¦çš„æŠ€æœ¯ï¼Œåœ¨ä¸€ä¸ªå…¬å¸è¦ä¸è¦å±•å¼€è‡ªåŠ¨åŒ–æ˜¯éœ€è¦è€ƒè™‘è‡ªåŠ¨åŒ–æŠ•å…¥å’Œäº§å‡ºæ˜¯å¦æˆæ­£æ¯”ã€‚å½“ç„¶é’ˆå¯¹ä¸ªäººå‘å±•æ¥è¯´æŠ€å¤šä¸å‹èº«ï¼Œä»Šå¤©çš„è¿™ç¯‡æ–‡ç« æ˜¯å€Ÿé‰´ä»–äººçš„ä»£ç è‡ªå·±æ•´ç†å‡ºçš„ä¸€äº›é€»è¾‘ï¼Œå¸Œæœ›åœ¨ä»¥åçš„æ—¥å­é‡Œå¯ä»¥æ·±å…¥ç ”ç©¶


## å‰ç½®æ¡ä»¶
1. å®‰è£…[Python](https://www.python.org/)
2. å®‰è£…[Pycharm](http://www.jetbrains.com/pycharm/?fromMenu)
3. å®‰è£…ç±»åº“ï¼šUnittestï¼›requestï¼›appiumï¼›seleniumï¼›HMLTestRunnerç­‰
4. å®‰è£…[Adb](https://blog.csdn.net/vsrfind/article/details/79593098)
5. å®‰è£…[Node.js](https://nodejs.org/en/download/)
6. ä½¿ç”¨å‘½ä»¤è¡Œå®‰è£…[npmæ·˜å®é•œåƒ]sudo npm install -g cnpm --registry=https://registry.npm.taobao.org --verbose
7. å®‰è£…[appium desktop](https://testerhome.com/topics/680)
---

## 1.é…ç½®ç¯å¢ƒ
### 1.1 Adbç¡®å®šè¿æ¥
* é¦–å…ˆæ‰‹æœºéœ€è¦æ‰“å¼€å¼€å‘è€…é€‰é¡¹ï¼Œç„¶åä½¿ç”¨ç”µè„‘é€šè¿‡æ•°æ®çº¿è¿æ¥æ‰‹æœºï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤å°±å¯æŸ¥çœ‹æ‰‹æœºå’Œç”µè„‘æ˜¯å¦è¿æ¥æˆåŠŸ
```
1. adb   æ²¡æœ‰æç¤ºé”™è¯¯ä¿¡æ¯åˆ™æ˜¾ç¤ºadbå®‰è£…æˆåŠŸ
2. adb devices  å‡ºç°è®¾å¤‡ä¿¡æ¯åˆ™æ˜¾ç¤ºç”µè„‘å’Œæ‰‹æœºè¿æ¥æˆåŠŸ
```
![Vaj6zj.png](https://s2.ax1x.com/2019/06/06/Vaj6zj.png)

### 1.2 Appium desktopé…ç½®
* æ‰“å¼€appium desktopä¸­è®¾ç½®hostä¸º`127.0.0.1`ï¼Œpostä¸ºé»˜è®¤ã€‚ç‚¹å‡»`Start Server v1.10.0`æŒ‰é’®
[![VXnTUS.png](https://s2.ax1x.com/2019/06/19/VXnTUS.png)](https://imgchr.com/i/VXnTUS)

* ç‚¹å‡»è¿æ¥åæ‰“å¼€å³ä¸Šè§’çš„ğŸ”æŒ‰é’®
[![VXnxbV.png](https://s2.ax1x.com/2019/06/19/VXnxbV.png)](https://imgchr.com/i/VXnxbV)

* åœ¨é…ç½® `Desired Capabilities`æ ‡ç­¾ä¸‹è¾“å…¥`æœºå‹`ã€`ç‰ˆæœ¬`ã€`è®¾å¤‡åç§°`ã€`å¯åŠ¨appçš„åŒ…åœ°å€`ã€`appçš„æ´»åŠ¨åç§°`ã€`æ¯æ¬¡ä¸é‡ç½®`ç­‰ï¼Œåœ¨å³ä¸‹è§’å¯ç‚¹å‡»`ä¿å­˜`ã€`å¦å­˜ä¸º`ã€`æ ¹æ®ä¸Šè¿°é…ç½®å¼€å§‹æ‰§è¡Œ`
[![VXu95F.png](https://s2.ax1x.com/2019/06/19/VXu95F.png)](https://imgchr.com/i/VXu95F)

* åœ¨`Saved Capability Sets`æ ‡ç­¾ä¸‹å¯ä»¥çœ‹åˆ°åˆšåˆšé…ç½®çš„ä¿¡æ¯
```
{
  "platformName": "Android",         
  "platformVersion": "5.0.2",
  "deviceName": "79ZTWK9599999999",
  "appPackage": "com.tencent.mm",
  "appActivity": "com.tencent.mm.ui.LauncherUI",
  "noReset": true
}
```
[![VXKTpQ.png](https://s2.ax1x.com/2019/06/19/VXKTpQ.png)](https://imgchr.com/i/VXKTpQ)

* è¿æ¥æ‰‹æœºåï¼Œåœ¨é…ç½®å¥½çš„é¡µé¢ç‚¹å‡»`Start Session`æŒ‰é’®ï¼Œå¯ä»¥åœ¨é¡µé¢å®šä½åˆ°`element`å®šä½ï¼Œè·å–åˆ°ç‚¹å‡»çš„å…ƒç´ å„ä¸ªå±æ€§ä»¥åŠè¯¥å…ƒç´ çš„xpathå®šä½
[![VXKH6s.png](https://s2.ax1x.com/2019/06/19/VXKH6s.png)](https://imgchr.com/i/VXKH6s)


ok,å¦‚æœä»¥ä¸Šçš„éƒ½å®Œæˆäº†ï¼Œæ­å–œä½ æ‰€æœ‰çš„é…ç½®ç¯å¢ƒéƒ½Doneï¼

## 2.ä»£ç å®ç°é€»è¾‘

* åœ¨ç¼–å†™ä»£ç å‰ä¸€å®šè¦è®¾è®¡å¥½æ•´ä¸ªæ¡†æ¶åŠæ¡†æ¶çš„çš„ç»“æ„ï¼Œç¼–å†™UIå°ç¨‹åºè‡ªåŠ¨åŒ–å¼•ç”¨çš„æ˜¯Appiumæ¡†æ¶ï¼Œä¸»è¦ç¼–å†™çš„ä»£ç åˆ†ä¸ºå‡ ä¸ªå¤§ç±»`è®¾å¤‡åŸºç¡€ç±»`,`ä¸šåŠ¡æµç¨‹ç±»`, `Elementsç±» `, `å…¬å…±æ–¹æ³•ç±»`
[![ZS6NjS.png](https://s2.ax1x.com/2019/06/21/ZS6NjS.png)](https://imgchr.com/i/ZS6NjS)

### 2.1 Elementsç±»
* xpathç±»å…¶å®åœ¨ä¹‹å‰ä¹Ÿè¯´è¿‡ï¼Œä¸»è¦æ˜¯ç”¨äºå®šä½å…ƒç´ çš„å…¬å…±ç±»ï¼Œä»»ä½•é¡µé¢çš„ç‚¹å‡»éƒ½ä¼šè§¦å‘å®šä½å…ƒç´ ï¼Œæ–¹ä¾¿å…ƒç´ æ›´å¥½çš„å®šä½ã€‚Appiumåœ¨å®šä½ä¸­ä½¿ç”¨çš„å…ƒç´ æ–¹å¼æœ‰å¾ˆå¤šç§å¸¸ç”¨çš„æœ‰ï¼šä¾‹å¦‚`Xpath`ã€`id`ã€`name`ã€`ClassName`ã€`AccessibilityId`ã€ç­‰æ–¹å¼ã€‚åœ¨`AllPageElements`ä¸­ä¸‹å¯¹ä¸åŒçš„é¡µé¢åˆ›å»ºä¸åŒçš„`.py`æ–‡ä»¶ï¼Œä¸»è¦æ˜¯é€šè¿‡`Xpath`æ–¹æ³•å®šä½ã€‚ä¾‹å¦‚`ä¸»é¡µ`å®šä½
```
class HomePage():
    elementList = {
        #åœ¨é¦–é¡µç‚¹å‡»ç¬¬ä¸€ä¸ªå•†å“
        'firstGoods' : '/hierarchy/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.RelativeLayout/android.widget.FrameLayout[1]/android.widget.RelativeLayout/android.widget.FrameLayout[2]/android.widget.FrameLayout/android.widget.FrameLayout[1]/android.widget.FrameLayout/android.view.ViewGroup/android.widget.FrameLayout/android.widget.FrameLayout[1]/android.webkit.WebView/android.view.View/android.view.View[5]/android.view.View[1]/android.view.View/android.view.View[1]/android.view.View[1]/android.view.View[2]/android.widget.Image',

        #å³ä¸Šè§’çš„"Â·Â·Â·"
        'more' : '//android.widget.ImageButton[@content-desc=\"æ›´å¤š\"]',

        #ç‚¹å‡»å®Œå³ä¸Šè§’çš„"Â·Â·Â·"åï¼Œå‡ºç°çš„è’™å±‚é¡µã€‚ç‚¹å‡»åˆ†äº«ã€‚
        'moreShare' : '/hierarchy/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.view.ViewGroup/android.widget.FrameLayout/android.widget.LinearLayout/android.support.v7.widget.RecyclerView/android.widget.LinearLayout[1]/android.widget.LinearLayout/android.widget.TextView',

        #é€‰æ‹©åˆ†äº«å¯¹è±¡
        'shareForward' : '//android.widget.FrameLayout[@content-desc=\"å½“å‰æ‰€åœ¨é¡µé¢,é€‰æ‹©\"]/android.widget.LinearLayout/android.widget.FrameLayout/android.view.ViewGroup/android.widget.FrameLayout[1]/android.widget.FrameLayout/android.widget.RelativeLayout/android.widget.ListView/android.widget.RelativeLayout[2]/android.widget.LinearLayout/android.widget.LinearLayout/android.widget.LinearLayout',

        #ç‚¹å‡»å‘é€
        'shareSend' : '/hierarchy/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.LinearLayout/android.widget.LinearLayout[2]/android.widget.LinearLayout/android.widget.Button[2]',

        #æˆ‘çš„
        'my' : '/hierarchy/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.RelativeLayout/android.widget.FrameLayout[2]/android.widget.LinearLayout/android.widget.RelativeLayout[3]/android.widget.LinearLayout/android.widget.ImageView',

        #é¦–é¡µ
        'homePage' : '/hierarchy/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.RelativeLayout/android.widget.FrameLayout[2]/android.widget.LinearLayout/android.widget.RelativeLayout[1]/android.widget.LinearLayout/android.widget.TextView',

        #é€€å‡ºå°ç¨‹åº
        'exit' : '//android.widget.ImageButton[@content-desc="å…³é—­"]',

        #ä»å¾®ä¿¡è¿›å…¥å°ç¨‹åºï¼ˆQAï¼šæ‹¼æ‹¼åˆ°å®¶ï¼‰
        'miniProEnter' : '//android.widget.FrameLayout[@content-desc="å½“å‰æ‰€åœ¨é¡µé¢,ä¸çš„èŠå¤©"]/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.view.ViewGroup/android.widget.FrameLayout[1]/android.widget.FrameLayout/android.widget.FrameLayout/com.tencent.mm.ui.mogic.WxViewPager/android.widget.FrameLayout/android.widget.RelativeLayout/android.widget.ListView/android.widget.FrameLayout/android.support.v7.widget.RecyclerView/android.widget.RelativeLayout[1]/android.widget.FrameLayout/android.widget.ImageView[1]',

        #ç¤¾åŒºåç§°
        'communityName' : '/hierarchy/android.widget.FrameLayout/android.widget.LinearLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.FrameLayout/android.widget.RelativeLayout/android.widget.FrameLayout[1]/android.widget.RelativeLayout/android.widget.FrameLayout[2]/android.widget.FrameLayout/android.widget.FrameLayout[1]/android.widget.FrameLayout/android.view.ViewGroup/android.widget.FrameLayout/android.widget.FrameLayout[1]/android.webkit.WebView/android.view.View/android.view.View[1]/android.view.View[2]',



    }
```
### 2.2 å…¬å…±æ–¹æ³•ç±»
* å…¬å…±æ–¹æ³•ç±»ç›´ç™½çš„è¯´å°±æ˜¯å®šä½å…ƒç´ çš„å…¬å…±ç±»ï¼Œä¸åŒçš„å®šä½å…ƒç´ å¯èƒ½ä¼šæœ‰ç›¸åŒçš„å®šä½æ–¹å¼ï¼Œåªæ˜¯ç´¢å¼•ä¸åŒã€‚æ•…æ­¤åˆ›å»ºäº†å…¬å…±æ–¹æ³•ç±»é¿å…æ¯æ¬¡è°ƒç”¨éƒ½è¦åˆ›å»ºï¼Œå…¶å®è¿™ä¹Ÿæ˜¯æ–¹ä¾¿`Elementsç±»`,ä½¿çš„æ¯æ¬¡è°ƒç”¨ç›¸åŒçš„å®šä½æ–¹æ³•å¯ç›´æ¥ä»`å…¬å…±æ–¹æ³•ç±»`ä¸­è·å–å°±è¡Œã€‚
```
class Find_Element():


    '''
        æ‘˜è¦ï¼šä»¥xpathå®šä½å…ƒç´ 
        å‚æ•°ä»‹ç»ï¼š
            driverï¼šappiumé©±åŠ¨å¯¹è±¡
            xpathï¼šéœ€è¦æŸ¥è¯¢å…ƒç´ çš„æ¡ä»¶
            msgï¼šéœ€è¦æ‰“å°çš„ä¿¡æ¯ï¼ŒæˆåŠŸå¤±è´¥ä¸ç”¨å†™ï¼ˆå¿…é¡»æ‰“å°ï¼‰
            indexï¼šé»˜è®¤ä¸º0ï¼Œå€¼ä¸ºå¾—åˆ°listä¸­çš„åºæ•°
            send_keysï¼šé»˜è®¤ä¸º1ï¼Œä¸ä¼ å€¼ï¼Œå½“send_keysä¸ºå…¶ä»–å€¼æ—¶ï¼Œåˆ™ä¼ å€¼
            keysï¼šå½“éœ€è¦ä¼ å€¼æ—¶ï¼Œä¼ çš„å€¼æ˜¯å¤šå°‘
    '''
    def by_xpath(self,driver,xpath,msg,index=0,send_keys=1,keys=''):
        el = driver.find_elements_by_xpath(xpath)
        #print(msg)
        #print(driver.page_source)
        #send_keysä¸º1æ—¶ï¼Œåˆ™è®¤ä¸ºä¸éœ€è¦ä¼ å€¼
        self.judgeAndPrint(el, msg, index, send_keys, keys)
```

### 2.3 è®¾å¤‡åŸºç¡€ç±»
* ä»å¼€å§‹å‡†å¤‡ç¯å¢ƒä¸­å·²ç»å‡†å¤‡ç¯å¢ƒå˜é‡ï¼ŒåŒ…æ‹¬å®‰è£…è½¯ä»¶ï¼Œé…ç½®Appium,å®šä½å…ƒç´ åŠadb ä½¿ç”¨ç­‰ï¼Œè¿™äº›å‰ææ¡ä»¶å‡†å¤‡å¥½åå°±èƒ½å†™ä»£ç å®ç°UIè‡ªåŠ¨åŒ–çš„ç¼–ç¨‹é€»è¾‘ã€‚`è®¾å¤‡åŸºç¡€ç±»`æ˜¯æ•´ä¸ªå®ç°ä»£ç çš„åŸºç¡€ï¼Œæ˜¯ä»£ç è¿æ¥è®¾å¤‡çš„æ¡¥æ¢ã€‚ä¸»è¦åŒ…æ‹¬è®¾å¤‡åç§°ã€è®¾å¤‡ç‰ˆæœ¬ã€è®¾å¤‡æ“ä½œç³»ç»Ÿã€è®¾å¤‡é”®ç›˜ã€è®¾å¤‡å®‰è£…åŒ…ç­‰ã€‚
```
class devices():

    # @staticmethod
    def setUp(self):
        desired_caps={}
        desired_caps['platformName'] = 'Android'
        desired_caps['platformVersion'] = '8.0.0'   #å®‰å“ç‰ˆæœ¬
        # desired_caps['platformVersion'] = '5.0.2'   #å®‰å“ç‰ˆæœ¬
        desired_caps['deviceName'] = '37KRX18A15018322'      #è®¾å¤‡åç§°   åä¸ºè£è€€9ié’æ˜¥ç‰ˆ--ç”°é‡
        # desired_caps['deviceName'] = '79ZTWK9599999999'  # è®¾å¤‡åç§°   ä¸‰æ˜ŸS8--äº‘éœ
        desired_caps['noReset'] = True              #é”®ç›˜æ˜¯ä¸æ˜¯è¦å¼€å¯
        desired_caps['appPackage'] = 'com.tencent.mm'  #å®‰è£…çš„åŒ…åœ°å€
        desired_caps['appActivity'] = 'com.tencent.mm.ui.LauncherUI'
        driver=webdriver.Remote('http://127.0.0.1:4723/wd/hub', desired_caps)
        #driver.find_elements_by_class_name()
        #el_test=driver.find_element_by_xpath('asdfasdfasf')
        #el_test.
        return driver
        #webdriver.webdriver.WebDriver.get_window_size()
```
### 2.4 ä¸šåŠ¡æµç¨‹ç±»
* ä¸šåŠ¡æµç¨‹ç±»ä¸»è¦æ˜¯æŒ‰ç…§æ­£å¸¸çš„ä¸šåŠ¡åœºæ™¯æ¢³ç†çš„ä¸šåŠ¡æµç¨‹ï¼Œå½“ç„¶è¿™ä¹Ÿå¯ä»¥åˆ†ä¸åŒçš„åœºæ™¯ï¼Œä¸»æµç¨‹æˆ–è€…å•ä¸ªæµç¨‹ã€‚æœ¬æ¬¡æœ¬äººä»‹ç»çš„æ˜¯æŒ‰ç…§ä¸šåŠ¡ä¸»æµç¨‹è¿›è¡Œåˆ†æï¼Œä»ç”¨æˆ·çš„å¯åŠ¨å°ç¨‹åºåˆ°ç”¨æˆ·çš„é€‰æ‹©å•†å“å†åˆ°åŠ å…¥è´­ç‰©è½¦çš„å…¨è¿‡ç¨‹ã€‚ä»£ç å¦‚ä¸‹:
```
from com.MiniProgram.Main.AllPagesElements.GoodsDetail import GoodsDetail
#from com.MiniProgram.Main.devices.Devices import devices
from com.MiniProgram.Main.AllPagesElements.HomePage import HomePage
from com.MiniProgram.Main.CommonFunction.Find_Element import Find_Element
from com.MiniProgram.Main.devices.Devices import devices
from com.MiniProgram.Main.CommonFunction.Swipe import Swipe
from com.MiniProgram.Main.AllPagesElements.OrderConfirm import OrderConfirm
from com.MiniProgram.Main.AllPagesElements.Pay import Pay
from com.MiniProgram.Main.AllPagesElements.ShopCar import ShopCar
from com.MiniProgram.Main.CommonFunction.TimeWait import TimeWait

import time
class MiniPro_buyMainFlow():
    # login=login()
    # å¯åŠ¨è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè·å–driver

    #driver = login().login_autoTest()

    # åˆå§‹åŒ–å¹¶è·å–driver
    driver = devices().setUp()
    time.sleep(8)
    Swipe().swipe(driver,0.5,0.5,0.3,0.8,1000)
    time.sleep(1)

    Find_Element().by_xpath(driver,HomePage().elementList['miniProEnter'],'QAå°ç¨‹åºç™»é™†')
    TimeWait().ExplicitWait(driver,HomePage.elementList['firstGoods'],30)

    # è¿›å…¥è¯¦æƒ…é¡µ
    Find_Element().by_xpath(driver,HomePage.elementList['firstGoods'],'ç‚¹å‡»ç¬¬ä¸€ä¸ªå•†å“')
    time.sleep(5)

    # ç‚¹å‡»åŠ å…¥è´­ç‰©è½¦
    Find_Element().by_xpath(driver,GoodsDetail().elementList['addToShopCar'],'ç‚¹å‡»åŠ å…¥è´­ç‰©è½¦')
    time.sleep(3)

    # å°†é»˜è®¤skuæ•°é‡+1
    Find_Element().by_xpath(driver, GoodsDetail().elementList['plus'], 'ç‚¹å‡»+')
    time.sleep(3)

    # æ”¹å®Œæ•°é‡åï¼Œç‚¹å‡»åŠ å…¥è´­ç‰©è½¦
    Find_Element().by_xpath(driver, GoodsDetail().elementList['toShopCarTrue'], 'ç‚¹å‡»åŠ å…¥è´­ç‰©è½¦')
    time.sleep(5)

```
ä»¥ä¸Šæ˜¯æŒ‰ç…§UIè‡ªåŠ¨åŒ–çš„æ¡†æ¶è¿›è¡Œçš„é€»è¾‘åˆ†æï¼Œåœ¨è‡ªåŠ¨åŒ–æ¡†æ¶ä¸­å…¶å®æœ‰å¾ˆå¤šç§é€‚ç”¨äºè‡ªå·±ä¸šåŠ¡çš„æ¡†æ¶ï¼Œé€‚åˆçš„æ‰æ˜¯å¥½çš„ã€‚UIè‡ªåŠ¨åŒ–ä¸»è¦æ˜¯ç•Œé¢çš„æ“ä½œï¼Œé€‚ç”¨äºå°ç¨‹åºã€webã€appç­‰å„ç§ç•Œé¢èƒ½æ“ä½œçš„ç¨‹åºã€‚









  